<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Cooldown Tracker</title>
<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, sans-serif;
  background: #0e0f12;
  color: #e5e7eb;
}

.container {
  padding: 12px;
  max-width: 600px;
  margin: auto;
}

.enemy {
  background: #15171c;
  padding: 14px;
  margin-bottom: 14px;
  border-radius: 10px;
}

.enemy-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

input[type="text"] {
  background: transparent;
  border: none;
  color: white;
  font-size: 16px;
  font-weight: bold;
  width: 140px;
}

.level-controls button {
  background: #22252b;
  color: white;
  border: none;
  padding: 6px 12px;
  font-size: 16px;
  border-radius: 6px;
}

.toggle {
  display: inline-flex;
  align-items: center;
  margin-right: 12px;
  font-size: 13px;
}

.toggle input {
  margin-right: 4px;
}

.spell-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 12px;
  background: #1b1e24;
  padding: 14px;
  border-radius: 8px;
  cursor: pointer;
  min-height: 60px;
}

select {
  background: #1b1e24;
  color: white;
  border: none;
  font-size: 14px;
}

.timer {
  font-weight: bold;
  font-size: 18px;
}

.ready {
  color: #22c55e;
}

.active {
  color: #ef4444;
}
</style>
</head>
<body>
<div class="container" id="app"></div>

<script>
const spells = {
  Flash: 300,
  Ignite: 180,
  Teleport: 0,
  Heal: 240,
  Exhaust: 240,
  Ghost: 210,
  Cleanse: 210,
  Smite: 90
};

function teleportBase(level) {
  if (level <= 6) return 360;
  if (level <= 10) return 300;
  return 240;
}

function adjustedCooldown(base, haste) {
  return Math.round(base * (100 / (100 + haste)));
}

function formatTime(seconds) {
  const m = Math.floor(seconds / 60).toString().padStart(2,'0');
  const s = (seconds % 60).toString().padStart(2,'0');
  return `${m}:${s}`;
}

class SpellTimer {
  constructor() {
    this.remaining = 0;
    this.interval = null;
  }

  start(duration, updateCallback) {
    this.remaining = duration;
    clearInterval(this.interval);
    this.interval = setInterval(() => {
      if (this.remaining > 0) {
        this.remaining--;
        updateCallback();
      } else {
        clearInterval(this.interval);
        updateCallback();
      }
    }, 1000);
  }

  reset(updateCallback) {
    clearInterval(this.interval);
    this.remaining = 0;
    updateCallback();
  }
}

function createEnemy(index) {
  const enemy = document.createElement('div');
  enemy.className = 'enemy';

  let level = 1;
  let boots = false;
  let cosmic = false;
  let crimson = false;

  const timer1 = new SpellTimer();
  const timer2 = new SpellTimer();

  function haste() {
    return (boots ? 10 : 0)
         + (cosmic ? 18 : 0)
         + (crimson ? 20 : 0); // adjust if needed
  }

  function getCooldown(spellName) {
    let base = spellName === "Teleport"
      ? teleportBase(level)
      : spells[spellName];
    return adjustedCooldown(base, haste());
  }

  enemy.innerHTML = `
    <div class="enemy-header">
      <input type="text" value="Enemy ${index}" />
      <div class="level-controls">
        <button class="minus">-</button>
        <span class="lvl">Lvl 1</span>
        <button class="plus">+</button>
      </div>
    </div>

    <div style="margin-top:8px;">
      <label class="toggle">
        <input type="checkbox" class="boots" /> Ionian
      </label>
      <label class="toggle">
        <input type="checkbox" class="cosmic" /> Cosmic
      </label>
      <label class="toggle">
        <input type="checkbox" class="crimson" /> Crimson
      </label>
    </div>

    <div class="spell-row spell1">
      <select>
        ${Object.keys(spells).map(s=>`<option>${s}</option>`).join('')}
      </select>
      <div class="timer ready">Ready</div>
    </div>

    <div class="spell-row spell2">
      <select>
        ${Object.keys(spells).map(s=>`<option>${s}</option>`).join('')}
      </select>
      <div class="timer ready">Ready</div>
    </div>
  `;

  const lvlSpan = enemy.querySelector('.lvl');

  enemy.querySelector('.minus').onclick = () => {
    if (level > 1) level--;
    lvlSpan.textContent = `Lvl ${level}`;
  };

  enemy.querySelector('.plus').onclick = () => {
    if (level < 18) level++;
    lvlSpan.textContent = `Lvl ${level}`;
  };

  enemy.querySelector('.boots').onchange = e => boots = e.target.checked;
  enemy.querySelector('.cosmic').onchange = e => cosmic = e.target.checked;
  enemy.querySelector('.crimson').onchange = e => crimson = e.target.checked;

 function setupSpell(row, timer) {
  const select = row.querySelector('select');
  const display = row.querySelector('.timer');

  function update() {
    if (timer.remaining > 0) {
      display.textContent = formatTime(timer.remaining);
      display.className = 'timer active';
    } else {
      display.textContent = 'Ready';
      display.className = 'timer ready';
    }
  }

  // Prevent select from triggering timer
  select.addEventListener('pointerdown', (e) => {
    e.stopPropagation();
  });

  // Only timer text is clickable
  display.addEventListener('pointerdown', () => {
    if (timer.remaining > 0) {
      timer.reset(update);
    } else {
      const cd = getCooldown(select.value);
      timer.start(cd, update);
    }
  });
}

  setupSpell(enemy.querySelector('.spell1'), timer1);
  setupSpell(enemy.querySelector('.spell2'), timer2);

  return enemy;
}

const app = document.getElementById('app');
for (let i = 1; i <= 5; i++) {
  app.appendChild(createEnemy(i));
}
</script>
</body>
</html>

